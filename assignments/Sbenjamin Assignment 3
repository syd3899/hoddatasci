---
title: "Sbenjamin Assignment 3"
output: html_document
---

Use the attrition dataset to answer the following questions. As always, your assignment must be turned in as a .Rmd file. 

1. Create a graph that shows the distribution of monthly income.
```{r  include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
library(RColorBrewer)
library(knitr)
```


```{r}

#at<-read_csv("WA_Fn-UseC_-HR-Employee-Attrition.csv")
load("at.Rdata")
```



```{r}
gg<-ggplot(at,aes(x=MonthlyIncome))
gg<-gg+geom_density()
gg

gg<-ggplot(at,aes(x=EducationField))
gg<-gg+geom_density()
gg

```


2. Create a graph that shows the average level of monthly income by field of education.



```{r}
at_sum<-at%>%
  group_by(EducationField)%>%
  summarize(inc_avg=mean(MonthlyIncome))%>%
  ungroup()%>%
  arrange(inc_avg)

at_sum

gg<-ggplot(at_sum,aes(EducationField,inc_avg),y=inc_avg)
gg<-gg+geom_bar(stat="identity",position="dodge")

gg<-gg+ylab("MonthlyIncome")+xlab("EducationField")
gg<-gg+theme(axis.text.x = element_text(angle=70,hjust=1))
gg
```

3. Create another graph that shows average level of monthly income by field of education and gender.

```{r}
at_sum<-at%>%
  group_by(EducationField,Gender)%>%
  summarize(inc_avg=mean(MonthlyIncome))%>%
  ungroup()%>%
  arrange(inc_avg)
at_sum

gg<-ggplot(at_sum,aes(EducationField,inc_avg),y=inc_avg)
gg<-gg+geom_bar(stat="identity",aes(fill=Gender),position="dodge")

gg<-gg+ylab("MonthlyIncome")+xlab("EducationField")
gg<-gg+theme(axis.text.x = element_text(angle=70,hjust=1))
gg
```


4. Create a graph that shows average levels of monthly income by field of education, gender and job level (scale of 1-5, highest ranked employees are 5)

```{r}
at_sum<-at%>%
  group_by(EducationField,JobLevel,Gender)%>%
  summarize(inc_avg=mean(attrit))%>%
  ungroup()%>%
  arrange(inc_avg)
at_sum

gg<-ggplot(at_sum,aes(EducationField,inc_avg),y=inc_avg)
gg<-gg+geom_bar(stat="identity",aes(fill=Gender),position="dodge")
gg<-gg+facet_wrap(~JobLevel,ncol=4)

gg<-gg+ylab("MonthlyIncome")+xlab("EducationField")
gg<-gg+theme(axis.text.x = element_text(angle=60,hjust=1))
gg
```

5. Create a graph that shows average levels of montly income by field of education, gender, job level and department. 

```{r}
at_sum<-at%>%
  group_by(EducationField,Gender,JobLevel,Department)%>%
  summarize(inc_avg=mean(MonthlyIncome))%>%
  ungroup()%>%
  arrange(inc_avg)

at_sum

gg<-ggplot(at_sum,aes(EducationField,inc_avg),y=inc_avg)
gg<-gg+geom_bar(stat="identity",aes(fill=JobLevel),position="dodge")
gg<-gg+facet_wrap(~Gender+Department,ncol=4)

gg<-gg+ylab("Average Monthly Income")+xlab("Education Field Level")
gg<-gg+theme(axis.text.x = element_text(angle = 60, hjust = 1))
gg<-gg+ggtitle("Monthly Income by Gender and Department")
gg

```
